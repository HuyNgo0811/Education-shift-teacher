var express = require('express');
var router = express.Router();
const Excel = require('exceljs');
const classModel = require('../model/classModel')
const teacherModel = require('../model/teacherModel')

router.get('/', async (req, res) => {
    const classes = await classModel.find(); // Lấy tất cả các lớp từ MongoDB
    const teachers = await teacherModel.find();

    const workbook = new Excel.Workbook();

    const worksheet = workbook.addWorksheet('classdata-not-edit');
    const worksheet2 = workbook.addWorksheet('teacherdata-not-edit');
    const worksheet3 = workbook.addWorksheet('Data-Filter-Ngang');
    const worksheet4 = workbook.addWorksheet('Data-Filter-Dọc');

    const classcolumns = [
      { header: 'ID Lớp', key: 'classID', width: 15 },
      { header: 'Tên lớp', key: 'name', width: 15 },
      { header: 'Khối', key: 'grade', width: 10 },
      { header: 'Cơ sở', key: 'place', width: 20 },
      { header: 'Khung giờ', key: 'time1', width: 15 },
      { header: 'Khung giờ', key: 'time2', width: 15 },
      { header: 'Giáo viên Toán (thủ công)', key: 'manualmathtea', width: 25 },
      { header: 'Giáo viên Anh Văn (thủ công)', key: 'manualengtea', width: 25 },
      { header: 'Giáo viên Ngữ Văn (thủ công)', key: 'manuallittea', width: 25 },
      { header: 'Giáo viên Khoa Học (thủ công)', key: 'manualscitea', width: 25 },
      { header: 'Giáo viên Lịch Sử (thủ công)', key: 'manualhistea', width: 25 },
      { header: 'Giáo viên Toán (tự động)', key: 'automathtea', width: 25 },
      { header: 'Giáo viên Anh Văn (tự động)', key: 'autoengtea', width: 25 },
      { header: 'Giáo viên Ngữ Văn (tự động)', key: 'autolittea', width: 25 },
      { header: 'Giáo viên Khoa Học (tự động)', key: 'autoscitea', width: 25 },
      { header: 'Giáo viên Lịch Sử (tự động)', key: 'autohistea', width: 25 },
      { header: 'Buổi 1', key: 'buoi1', width: 10 },
      { header: 'Buổi 2', key: 'buoi2', width: 10 },
      { header: 'Buổi 3', key: 'buoi3', width: 10 },
      { header: 'Buổi 4', key: 'buoi4', width: 10 },
      { header: 'Buổi 5', key: 'buoi5', width: 10 },
      { header: 'Buổi 6', key: 'buoi6', width: 10 },
      { header: 'Buổi 7', key: 'buoi7', width: 10 },
      { header: 'Buổi 8', key: 'buoi8', width: 10 },
      { header: 'Buổi 9', key: 'buoi9', width: 10 },
      { header: 'Buổi 10', key: 'buoi10', width: 10 },
      { header: 'Buổi 11', key: 'buoi11', width: 10 },
      { header: 'Buổi 12', key: 'buoi12', width: 10 },
      { header: 'Buổi 13', key: 'buoi13', width: 10 },
      { header: 'Buổi 14', key: 'buoi14', width: 10 },
      { header: 'Buổi 15', key: 'buoi15', width: 10 },
      { header: 'Buổi 16', key: 'buoi16', width: 10 },
      { header: 'Buổi 17', key: 'buoi17', width: 10 },
      { header: 'Buổi 18', key: 'buoi18', width: 10 },
      { header: 'Buổi 19', key: 'buoi19', width: 10 },
      { header: 'Buổi 20', key: 'buoi20', width: 10 },
      { header: 'Buổi 21', key: 'buoi21', width: 10 },
      { header: 'Buổi 22', key: 'buoi22', width: 10 },
      { header: 'Buổi 23', key: 'buoi23', width: 10 },
      { header: 'Buổi 24', key: 'buoi24', width: 10 },
      { header: 'Buổi 25', key: 'buoi25', width: 10 },
      { header: 'Buổi 26', key: 'buoi26', width: 10 },
      { header: 'Buổi 27', key: 'buoi27', width: 10 },
      { header: 'Buổi 28', key: 'buoi28', width: 10 },
      { header: 'Buổi 29', key: 'buoi29', width: 10 },
      { header: 'Buổi 30', key: 'buoi30', width: 10 },
      { header: 'Buổi 31', key: 'buoi31', width: 10 },
      { header: 'Buổi 32', key: 'buoi32', width: 10 },
      { header: 'Buổi 33', key: 'buoi33', width: 10 },
      { header: 'Buổi 34', key: 'buoi34', width: 10 },
      { header: 'Buổi 35', key: 'buoi35', width: 10 },
      { header: 'Buổi 36', key: 'buoi36', width: 10 },
      { header: 'Buổi 37', key: 'buoi37', width: 10 },
      { header: 'Buổi 38', key: 'buoi38', width: 10 },
      { header: 'Buổi 39', key: 'buoi39', width: 10 },
      { header: 'Buổi 40', key: 'buoi40', width: 10 },
      { header: 'Buổi 41', key: 'buoi41', width: 10 },
      { header: 'Buổi 42', key: 'buoi42', width: 10 },
      { header: 'Buổi 43', key: 'buoi43', width: 10 },
      { header: 'Buổi 44', key: 'buoi44', width: 10 },
      { header: 'Buổi 45', key: 'buoi45', width: 10 },
      { header: 'Buổi 46', key: 'buoi46', width: 10 },
      { header: 'Buổi 47', key: 'buoi47', width: 10 },
      { header: 'Buổi 48', key: 'buoi48', width: 10 },
      { header: 'Buổi 49', key: 'buoi49', width: 10 },
      { header: 'Buổi 50', key: 'buoi50', width: 10 },
      { header: 'Buổi 51', key: 'buoi51', width: 10 },
      { header: 'Buổi 52', key: 'buoi52', width: 10 },
      { header: 'Buổi 53', key: 'buoi53', width: 10 },
      { header: 'Buổi 54', key: 'buoi54', width: 10 },
      { header: 'Buổi 55', key: 'buoi55', width: 10 },
      { header: 'Buổi 56', key: 'buoi56', width: 10 },
      { header: 'Buổi 57', key: 'buoi57', width: 10 },
      { header: 'Buổi 58', key: 'buoi58', width: 10 },
      { header: 'Buổi 59', key: 'buoi59', width: 10 },
      { header: 'Buổi 60', key: 'buoi60', width: 10 },
      { header: 'Buổi 61', key: 'buoi61', width: 10 },
      { header: 'Buổi 62', key: 'buoi62', width: 10 },
      { header: 'Buổi 63', key: 'buoi63', width: 10 },
      { header: 'Buổi 64', key: 'buoi64', width: 10 },
      { header: 'Buổi 65', key: 'buoi65', width: 10 },
      { header: 'Buổi 66', key: 'buoi66', width: 10 },
      { header: 'Buổi 67', key: 'buoi67', width: 10 },
      { header: 'Buổi 68', key: 'buoi68', width: 10 },
      { header: 'Buổi 69', key: 'buoi69', width: 10 },
      { header: 'Buổi 70', key: 'buoi70', width: 10 },
      { header: 'Buổi 71', key: 'buoi71', width: 10 },
      { header: 'Buổi 72', key: 'buoi72', width: 10 },
      { header: 'Buổi 73', key: 'buoi73', width: 10 },
      { header: 'Buổi 74', key: 'buoi74', width: 10 },
      { header: 'Buổi 75', key: 'buoi75', width: 10 },
      { header: 'Buổi 76', key: 'buoi76', width: 10 },
      { header: 'Buổi 77', key: 'buoi77', width: 10 },
      { header: 'Buổi 78', key: 'buoi78', width: 10 },
      { header: 'Buổi 79', key: 'buoi79', width: 10 },
      { header: 'Buổi 80', key: 'buoi80', width: 10 },
      { header: 'Buổi 81', key: 'buoi81', width: 10 },
      { header: 'Buổi 82', key: 'buoi82', width: 10 },
      { header: 'Buổi 83', key: 'buoi83', width: 10 },
      { header: 'Buổi 84', key: 'buoi84', width: 10 },
      { header: 'Buổi 85', key: 'buoi85', width: 10 },
      { header: 'Buổi 86', key: 'buoi86', width: 10 },
      { header: 'Buổi 87', key: 'buoi87', width: 10 },
      { header: 'Buổi 88', key: 'buoi88', width: 10 },
      { header: 'Buổi 89', key: 'buoi89', width: 10 },
      { header: 'Buổi 90', key: 'buoi90', width: 10 },
      { header: 'Buổi 91', key: 'buoi91', width: 10 },
      { header: 'Buổi 92', key: 'buoi92', width: 10 },
      { header: 'Buổi 93', key: 'buoi93', width: 10 },
      { header: 'Buổi 94', key: 'buoi94', width: 10 },
      { header: 'Buổi 95', key: 'buoi95', width: 10 },
      { header: 'Buổi 96', key: 'buoi96', width: 10 },
      { header: 'Buổi 97', key: 'buoi97', width: 10 },
      { header: 'Buổi 98', key: 'buoi98', width: 10 },
      { header: 'Buổi 99', key: 'buoi99', width: 10 },
      { header: 'Buổi 100', key: 'buoi100', width: 10 },
      { header: 'Buổi 101', key: 'buoi101', width: 10 },
      { header: 'Buổi 102', key: 'buoi102', width: 10 },
      { header: 'Buổi 103', key: 'buoi103', width: 10 },
      { header: 'Buổi 104', key: 'buoi104', width: 10 },
      { header: 'Buổi 105', key: 'buoi105', width: 10 },
      { header: 'Buổi 106', key: 'buoi106', width: 10 },
      { header: 'Buổi 107', key: 'buoi107', width: 10 },
      { header: 'Buổi 108', key: 'buoi108', width: 10 },
      { header: 'Buổi 109', key: 'buoi109', width: 10 },
      { header: 'Buổi 110', key: 'buoi110', width: 10 },
      { header: 'Buổi 111', key: 'buoi111', width: 10 },
      { header: 'Buổi 112', key: 'buoi112', width: 10 },
      { header: 'Buổi 113', key: 'buoi113', width: 10 },
      { header: 'Buổi 114', key: 'buoi114', width: 10 },
      { header: 'Buổi 115', key: 'buoi115', width: 10 },
      { header: 'Buổi 116', key: 'buoi116', width: 10 },
      { header: 'Buổi 117', key: 'buoi117', width: 10 },
      { header: 'Buổi 118', key: 'buoi118', width: 10 },
      { header: 'Buổi 119', key: 'buoi119', width: 10 },
      { header: 'Buổi 120', key: 'buoi120', width: 10 },
      { header: 'Buổi 121', key: 'buoi121', width: 10 },
      { header: 'Buổi 122', key: 'buoi122', width: 10 },
      { header: 'Buổi 123', key: 'buoi123', width: 10 },
      { header: 'Buổi 124', key: 'buoi124', width: 10 },
      { header: 'Buổi 125', key: 'buoi125', width: 10 },
      { header: 'Buổi 126', key: 'buoi126', width: 10 },
      { header: 'Buổi 127', key: 'buoi127', width: 10 },
      { header: 'Buổi 128', key: 'buoi128', width: 10 },
      { header: 'Buổi 129', key: 'buoi129', width: 10 },
      { header: 'Buổi 130', key: 'buoi130', width: 10 },
      { header: 'Buổi 131', key: 'buoi131', width: 10 },
      { header: 'Buổi 132', key: 'buoi132', width: 10 },
      { header: 'Buổi 133', key: 'buoi133', width: 10 },
      { header: 'Buổi 134', key: 'buoi134', width: 10 },
      { header: 'Buổi 135', key: 'buoi135', width: 10 },
      { header: 'Buổi 136', key: 'buoi136', width: 10 },
      { header: 'Buổi 137', key: 'buoi137', width: 10 },
      { header: 'Buổi 138', key: 'buoi138', width: 10 },
      { header: 'Buổi 139', key: 'buoi139', width: 10 },
      { header: 'Buổi 140', key: 'buoi140', width: 10 },
      { header: 'Buổi 141', key: 'buoi141', width: 10 },
      { header: 'Buổi 142', key: 'buoi142', width: 10 },
      { header: 'Buổi 143', key: 'buoi143', width: 10 },
      { header: 'Buổi 144', key: 'buoi144', width: 10 },
      { header: 'Buổi 145', key: 'buoi145', width: 10 },
      { header: 'Buổi 146', key: 'buoi146', width: 10 },
      { header: 'Buổi 147', key: 'buoi147', width: 10 },
      { header: 'Buổi 148', key: 'buoi148', width: 10 },
      { header: 'Buổi 149', key: 'buoi149', width: 10 },
      { header: 'Buổi 150', key: 'buoi150', width: 10 },
      { header: 'Buổi 151', key: 'buoi151', width: 10 },
      { header: 'Buổi 152', key: 'buoi152', width: 10 },
      { header: 'Buổi 153', key: 'buoi153', width: 10 },
      { header: 'Buổi 154', key: 'buoi154', width: 10 },
      { header: 'Buổi 155', key: 'buoi155', width: 10 },
      { header: 'Buổi 156', key: 'buoi156', width: 10 }
    ];
    const teachercolumns = [
      {header: 'ID giáo viên', key: 'teacherID', width: 20 },
      {header: 'Tên', key: 'name', width: 30 },
      {header: 'Dạy môn', key: 'subject', width: 15 },
      {header: 'Lớp', key: 'grade1', width: 6 },
      {header: 'Lớp', key: 'grade2', width: 6 },
      {header: 'Lớp', key: 'grade3', width: 6 },
      {header: 'Lớp', key: 'grade4', width: 6 },
      {header: 'Lớp', key: 'grade5', width: 6 },
      {header: 'Lớp', key: 'grade6', width: 6 },
      {header: 'Lớp', key: 'grade7', width: 6 },
      {header: 'Lớp', key: 'grade8', width: 6 },
      {header: 'Cơ Sở', key: 'place1', width: 10 },
      {header: 'Cơ Sở', key: 'place2', width: 10 },
      {header: 'Cơ Sở', key: 'place3', width: 10 },
      {header: 'Cơ Sở', key: 'place4', width: 10 },
      {header: 'Cơ Sở', key: 'place5', width: 10 },
      {header: 'Cơ Sở', key: 'place6', width: 10 },
      {header: 'Cơ Sở', key: 'place7', width: 10 },
      {header: 'Cơ Sở', key: 'place8', width: 10 },
      {header: 'Cơ Sở', key: 'place9', width: 10 },
      {header: 'Cơ Sở', key: 'place10', width: 10 },
      {header: 'Thời gian', key: 'time1', width: 15 },
      {header: 'Thời gian', key: 'time2', width: 15 },
      {header: 'Thời gian', key: 'time3', width: 15 },
      {header: 'Thời gian', key: 'time4', width: 15 },
      {header: 'Thời gian', key: 'time5', width: 15 },
      {header: 'Thời gian', key: 'time6', width: 15 },
      {header: 'Thời gian', key: 'time7', width: 15 },
      {header: 'Thời gian', key: 'time8', width: 15 },
      {header: 'Thời gian', key: 'time9', width: 15 },
      {header: 'Thời gian', key: 'time10', width: 15 },
      {header: 'Thời gian', key: 'time11', width: 15 },
      {header: 'Thời gian', key: 'time12', width: 15 },
      {header: 'Thời gian', key: 'time13', width: 15 },
      { header: 'Buổi 1', key: 'buoi1', width: 10 },
      { header: 'Buổi 2', key: 'buoi2', width: 10 },
      { header: 'Buổi 3', key: 'buoi3', width: 10 },
      { header: 'Buổi 4', key: 'buoi4', width: 10 },
      { header: 'Buổi 5', key: 'buoi5', width: 10 },
      { header: 'Buổi 6', key: 'buoi6', width: 10 },
      { header: 'Buổi 7', key: 'buoi7', width: 10 },
      { header: 'Buổi 8', key: 'buoi8', width: 10 },
      { header: 'Buổi 9', key: 'buoi9', width: 10 },
      { header: 'Buổi 10', key: 'buoi10', width: 10 },
      { header: 'Buổi 11', key: 'buoi11', width: 10 },
      { header: 'Buổi 12', key: 'buoi12', width: 10 },
      { header: 'Buổi 13', key: 'buoi13', width: 10 },
      { header: 'Buổi 14', key: 'buoi14', width: 10 },  
      { header: 'Buổi 15', key: 'buoi15', width: 10 },
      { header: 'Buổi 16', key: 'buoi16', width: 10 },
      { header: 'Buổi 17', key: 'buoi17', width: 10 },
      { header: 'Buổi 18', key: 'buoi18', width: 10 },
      { header: 'Buổi 19', key: 'buoi19', width: 10 },
      { header: 'Buổi 20', key: 'buoi20', width: 10 },
      { header: 'Buổi 21', key: 'buoi21', width: 10 },
      { header: 'Buổi 22', key: 'buoi22', width: 10 },
      { header: 'Buổi 23', key: 'buoi23', width: 10 },
      { header: 'Buổi 24', key: 'buoi24', width: 10 },
      { header: 'Buổi 25', key: 'buoi25', width: 10 },
      { header: 'Buổi 26', key: 'buoi26', width: 10 },
      { header: 'Buổi 27', key: 'buoi27', width: 10 },
      { header: 'Buổi 28', key: 'buoi28', width: 10 },
      { header: 'Buổi 29', key: 'buoi29', width: 10 },
      { header: 'Buổi 30', key: 'buoi30', width: 10 },
      { header: 'Buổi 31', key: 'buoi31', width: 10 },
      { header: 'Buổi 32', key: 'buoi32', width: 10 },
      { header: 'Buổi 33', key: 'buoi33', width: 10 },
      { header: 'Buổi 34', key: 'buoi34', width: 10 },
      { header: 'Buổi 35', key: 'buoi35', width: 10 },
      { header: 'Buổi 36', key: 'buoi36', width: 10 },
      { header: 'Buổi 37', key: 'buoi37', width: 10 },
      { header: 'Buổi 38', key: 'buoi38', width: 10 },
      { header: 'Buổi 39', key: 'buoi39', width: 10 },
      { header: 'Buổi 40', key: 'buoi40', width: 10 },
      { header: 'Buổi 41', key: 'buoi41', width: 10 },
      { header: 'Buổi 42', key: 'buoi42', width: 10 },
      { header: 'Buổi 43', key: 'buoi43', width: 10 },
      { header: 'Buổi 44', key: 'buoi44', width: 10 },
      { header: 'Buổi 45', key: 'buoi45', width: 10 },
      { header: 'Buổi 46', key: 'buoi46', width: 10 },
      { header: 'Buổi 47', key: 'buoi47', width: 10 },
      { header: 'Buổi 48', key: 'buoi48', width: 10 },
      { header: 'Buổi 49', key: 'buoi49', width: 10 },
      { header: 'Buổi 50', key: 'buoi50', width: 10 },
      { header: 'Buổi 51', key: 'buoi51', width: 10 },
      { header: 'Buổi 52', key: 'buoi52', width: 10 },
      { header: 'Buổi 53', key: 'buoi53', width: 10 },
      { header: 'Buổi 54', key: 'buoi54', width: 10 },
      { header: 'Buổi 55', key: 'buoi55', width: 10 },
      { header: 'Buổi 56', key: 'buoi56', width: 10 },
      { header: 'Buổi 57', key: 'buoi57', width: 10 },
      { header: 'Buổi 58', key: 'buoi58', width: 10 },
      { header: 'Buổi 59', key: 'buoi59', width: 10 },
      { header: 'Buổi 60', key: 'buoi60', width: 10 },
      { header: 'Buổi 61', key: 'buoi61', width: 10 },
      { header: 'Buổi 62', key: 'buoi62', width: 10 },
      { header: 'Buổi 63', key: 'buoi63', width: 10 },
      { header: 'Buổi 64', key: 'buoi64', width: 10 },
      { header: 'Buổi 65', key: 'buoi65', width: 10 },
      { header: 'Buổi 66', key: 'buoi66', width: 10 },
      { header: 'Buổi 67', key: 'buoi67', width: 10 },
      { header: 'Buổi 68', key: 'buoi68', width: 10 },
      { header: 'Buổi 69', key: 'buoi69', width: 10 },
      { header: 'Buổi 70', key: 'buoi70', width: 10 },
      { header: 'Buổi 71', key: 'buoi71', width: 10 },
      { header: 'Buổi 72', key: 'buoi72', width: 10 },
      { header: 'Buổi 73', key: 'buoi73', width: 10 },
      { header: 'Buổi 74', key: 'buoi74', width: 10 },
      { header: 'Buổi 75', key: 'buoi75', width: 10 },
      { header: 'Buổi 76', key: 'buoi76', width: 10 },
      { header: 'Buổi 77', key: 'buoi77', width: 10 },
      { header: 'Buổi 78', key: 'buoi78', width: 10 },
      { header: 'Buổi 79', key: 'buoi79', width: 10 },
      { header: 'Buổi 80', key: 'buoi80', width: 10 },
      { header: 'Buổi 81', key: 'buoi81', width: 10 },
      { header: 'Buổi 82', key: 'buoi82', width: 10 },
      { header: 'Buổi 83', key: 'buoi83', width: 10 },
      { header: 'Buổi 84', key: 'buoi84', width: 10 },
      { header: 'Buổi 85', key: 'buoi85', width: 10 },
      { header: 'Buổi 86', key: 'buoi86', width: 10 },
      { header: 'Buổi 87', key: 'buoi87', width: 10 },
      { header: 'Buổi 88', key: 'buoi88', width: 10 },
      { header: 'Buổi 89', key: 'buoi89', width: 10 },
      { header: 'Buổi 90', key: 'buoi90', width: 10 },
      { header: 'Buổi 91', key: 'buoi91', width: 10 },
      { header: 'Buổi 92', key: 'buoi92', width: 10 },
      { header: 'Buổi 93', key: 'buoi93', width: 10 },
      { header: 'Buổi 94', key: 'buoi94', width: 10 },
      { header: 'Buổi 95', key: 'buoi95', width: 10 },
      { header: 'Buổi 96', key: 'buoi96', width: 10 },
      { header: 'Buổi 97', key: 'buoi97', width: 10 },
      { header: 'Buổi 98', key: 'buoi98', width: 10 },
      { header: 'Buổi 99', key: 'buoi99', width: 10 },
      { header: 'Buổi 100', key: 'buoi100', width: 10 },
      { header: 'Buổi 101', key: 'buoi101', width: 10 },
      { header: 'Buổi 102', key: 'buoi102', width: 10 },
      { header: 'Buổi 103', key: 'buoi103', width: 10 },
      { header: 'Buổi 104', key: 'buoi104', width: 10 },
      { header: 'Buổi 105', key: 'buoi105', width: 10 },
      { header: 'Buổi 106', key: 'buoi106', width: 10 },
      { header: 'Buổi 107', key: 'buoi107', width: 10 },
      { header: 'Buổi 108', key: 'buoi108', width: 10 },
      { header: 'Buổi 109', key: 'buoi109', width: 10 },
      { header: 'Buổi 110', key: 'buoi110', width: 10 },
      { header: 'Buổi 111', key: 'buoi111', width: 10 },
      { header: 'Buổi 112', key: 'buoi112', width: 10 },
      { header: 'Buổi 113', key: 'buoi113', width: 10 },
      { header: 'Buổi 114', key: 'buoi114', width: 10 },
      { header: 'Buổi 115', key: 'buoi115', width: 10 },
      { header: 'Buổi 116', key: 'buoi116', width: 10 },
      { header: 'Buổi 117', key: 'buoi117', width: 10 },
      { header: 'Buổi 118', key: 'buoi118', width: 10 },
      { header: 'Buổi 119', key: 'buoi119', width: 10 },
      { header: 'Buổi 120', key: 'buoi120', width: 10 },
      { header: 'Buổi 121', key: 'buoi121', width: 10 },
      { header: 'Buổi 122', key: 'buoi122', width: 10 },
      { header: 'Buổi 123', key: 'buoi123', width: 10 },
      { header: 'Buổi 124', key: 'buoi124', width: 10 },
      { header: 'Buổi 125', key: 'buoi125', width: 10 },
      { header: 'Buổi 126', key: 'buoi126', width: 10 },
      { header: 'Buổi 127', key: 'buoi127', width: 10 },
      { header: 'Buổi 128', key: 'buoi128', width: 10 },
      { header: 'Buổi 129', key: 'buoi129', width: 10 },
      { header: 'Buổi 130', key: 'buoi130', width: 10 },
      { header: 'Buổi 131', key: 'buoi131', width: 10 },
      { header: 'Buổi 132', key: 'buoi132', width: 10 },
      { header: 'Buổi 133', key: 'buoi133', width: 10 },
      { header: 'Buổi 134', key: 'buoi134', width: 10 },
      { header: 'Buổi 135', key: 'buoi135', width: 10 },
      { header: 'Buổi 136', key: 'buoi136', width: 10 },
      { header: 'Buổi 137', key: 'buoi137', width: 10 },
      { header: 'Buổi 138', key: 'buoi138', width: 10 },
      { header: 'Buổi 139', key: 'buoi139', width: 10 },
      { header: 'Buổi 140', key: 'buoi140', width: 10 },
      { header: 'Buổi 141', key: 'buoi141', width: 10 },
      { header: 'Buổi 142', key: 'buoi142', width: 10 },
      { header: 'Buổi 143', key: 'buoi143', width: 10 },
      { header: 'Buổi 144', key: 'buoi144', width: 10 },
      { header: 'Buổi 145', key: 'buoi145', width: 10 },
      { header: 'Buổi 146', key: 'buoi146', width: 10 },
      { header: 'Buổi 147', key: 'buoi147', width: 10 },
      { header: 'Buổi 148', key: 'buoi148', width: 10 },
      { header: 'Buổi 149', key: 'buoi149', width: 10 },
      { header: 'Buổi 150', key: 'buoi150', width: 10 },
      { header: 'Buổi 151', key: 'buoi151', width: 10 },
      { header: 'Buổi 152', key: 'buoi152', width: 10 },
      { header: 'Buổi 153', key: 'buoi153', width: 10 },
      { header: 'Buổi 154', key: 'buoi154', width: 10 },
      { header: 'Buổi 155', key: 'buoi155', width: 10 },
      { header: 'Buổi 156', key: 'buoi156', width: 10 }
    ];
    const filterrows = [
      { header: 'Tên lớp', key: 'name' },
      { header: 'Buổi 1', key: 'buoi1' },
      { header: 'Buổi 2', key: 'buoi2' },
      { header: 'Buổi 3', key: 'buoi3' },
      { header: 'Buổi 4', key: 'buoi4' },
      { header: 'Buổi 5', key: 'buoi5' },
      { header: 'Buổi 6', key: 'buoi6' },
      { header: 'Buổi 7', key: 'buoi7' },
      { header: 'Buổi 8', key: 'buoi8' },
      { header: 'Buổi 9', key: 'buoi9' },
      { header: 'Buổi 10', key: 'buoi10' },
      { header: 'Buổi 11', key: 'buoi11' },
      { header: 'Buổi 12', key: 'buoi12' },
      { header: 'Buổi 13', key: 'buoi13' },
      { header: 'Buổi 14', key: 'buoi14' },
      { header: 'Buổi 15', key: 'buoi15' },
      { header: 'Buổi 16', key: 'buoi16' },
      { header: 'Buổi 17', key: 'buoi17' },
      { header: 'Buổi 18', key: 'buoi18' },
      { header: 'Buổi 19', key: 'buoi19' },
      { header: 'Buổi 20', key: 'buoi20' },
      { header: 'Buổi 21', key: 'buoi21' },
      { header: 'Buổi 22', key: 'buoi22' },
      { header: 'Buổi 23', key: 'buoi23' },
      { header: 'Buổi 24', key: 'buoi24' },
      { header: 'Buổi 25', key: 'buoi25' },
      { header: 'Buổi 26', key: 'buoi26' },
      { header: 'Buổi 27', key: 'buoi27' },
      { header: 'Buổi 28', key: 'buoi28' },
      { header: 'Buổi 29', key: 'buoi29' },
      { header: 'Buổi 30', key: 'buoi30' },
      { header: 'Buổi 31', key: 'buoi31' },
      { header: 'Buổi 32', key: 'buoi32' },
      { header: 'Buổi 33', key: 'buoi33' },
      { header: 'Buổi 34', key: 'buoi34' },
      { header: 'Buổi 35', key: 'buoi35' },
      { header: 'Buổi 36', key: 'buoi36' },
      { header: 'Buổi 37', key: 'buoi37' },
      { header: 'Buổi 38', key: 'buoi38' },
      { header: 'Buổi 39', key: 'buoi39' },
      { header: 'Buổi 40', key: 'buoi40' },
      { header: 'Buổi 41', key: 'buoi41' },
      { header: 'Buổi 42', key: 'buoi42' },
      { header: 'Buổi 43', key: 'buoi43' },
      { header: 'Buổi 44', key: 'buoi44' },
      { header: 'Buổi 45', key: 'buoi45' },
      { header: 'Buổi 46', key: 'buoi46' },
      { header: 'Buổi 47', key: 'buoi47' },
      { header: 'Buổi 48', key: 'buoi48' },
      { header: 'Buổi 49', key: 'buoi49' },
      { header: 'Buổi 50', key: 'buoi50' },
      { header: 'Buổi 51', key: 'buoi51' },
      { header: 'Buổi 52', key: 'buoi52' },
      { header: 'Buổi 53', key: 'buoi53' },
      { header: 'Buổi 54', key: 'buoi54' },
      { header: 'Buổi 55', key: 'buoi55' },
      { header: 'Buổi 56', key: 'buoi56' },
      { header: 'Buổi 57', key: 'buoi57' },
      { header: 'Buổi 58', key: 'buoi58' },
      { header: 'Buổi 59', key: 'buoi59' },
      { header: 'Buổi 60', key: 'buoi60' },
      { header: 'Buổi 61', key: 'buoi61' },
      { header: 'Buổi 62', key: 'buoi62' },
      { header: 'Buổi 63', key: 'buoi63' },
      { header: 'Buổi 64', key: 'buoi64' },
      { header: 'Buổi 65', key: 'buoi65' },
      { header: 'Buổi 66', key: 'buoi66' },
      { header: 'Buổi 67', key: 'buoi67' },
      { header: 'Buổi 68', key: 'buoi68' },
      { header: 'Buổi 69', key: 'buoi69' },
      { header: 'Buổi 70', key: 'buoi70' },
      { header: 'Buổi 71', key: 'buoi71' },
      { header: 'Buổi 72', key: 'buoi72' },
      { header: 'Buổi 73', key: 'buoi73' },
      { header: 'Buổi 74', key: 'buoi74' },
      { header: 'Buổi 75', key: 'buoi75' },
      { header: 'Buổi 76', key: 'buoi76' },
      { header: 'Buổi 77', key: 'buoi77' },
      { header: 'Buổi 78', key: 'buoi78' },
      { header: 'Buổi 79', key: 'buoi79' },
      { header: 'Buổi 80', key: 'buoi80' },
      { header: 'Buổi 81', key: 'buoi81' },
      { header: 'Buổi 82', key: 'buoi82' },
      { header: 'Buổi 83', key: 'buoi83' },
      { header: 'Buổi 84', key: 'buoi84' },
      { header: 'Buổi 85', key: 'buoi85' },
      { header: 'Buổi 86', key: 'buoi86' },
      { header: 'Buổi 87', key: 'buoi87' },
      { header: 'Buổi 88', key: 'buoi88' },
      { header: 'Buổi 89', key: 'buoi89' },
      { header: 'Buổi 90', key: 'buoi90' },
      { header: 'Buổi 91', key: 'buoi91' },
      { header: 'Buổi 92', key: 'buoi92' },
      { header: 'Buổi 93', key: 'buoi93' },
      { header: 'Buổi 94', key: 'buoi94' },
      { header: 'Buổi 95', key: 'buoi95' },
      { header: 'Buổi 96', key: 'buoi96' },
      { header: 'Buổi 97', key: 'buoi97' },
      { header: 'Buổi 98', key: 'buoi98' },
      { header: 'Buổi 99', key: 'buoi99' },
      { header: 'Buổi 100', key: 'buoi100' },
      { header: 'Buổi 101', key: 'buoi101' },
      { header: 'Buổi 102', key: 'buoi102' },
      { header: 'Buổi 103', key: 'buoi103' },
      { header: 'Buổi 104', key: 'buoi104' },
      { header: 'Buổi 105', key: 'buoi105' },
      { header: 'Buổi 106', key: 'buoi106' },
      { header: 'Buổi 107', key: 'buoi107' },
      { header: 'Buổi 108', key: 'buoi108' },
      { header: 'Buổi 109', key: 'buoi109' },
      { header: 'Buổi 110', key: 'buoi110' },
      { header: 'Buổi 111', key: 'buoi111' },
      { header: 'Buổi 112', key: 'buoi112' },
      { header: 'Buổi 113', key: 'buoi113' },
      { header: 'Buổi 114', key: 'buoi114' },
      { header: 'Buổi 115', key: 'buoi115' },
      { header: 'Buổi 116', key: 'buoi116' },
      { header: 'Buổi 117', key: 'buoi117' },
      { header: 'Buổi 118', key: 'buoi118' },
      { header: 'Buổi 119', key: 'buoi119' },
      { header: 'Buổi 120', key: 'buoi120' },
      { header: 'Buổi 121', key: 'buoi121' },
      { header: 'Buổi 122', key: 'buoi122' },
      { header: 'Buổi 123', key: 'buoi123' },
      { header: 'Buổi 124', key: 'buoi124' },
      { header: 'Buổi 125', key: 'buoi125' },
      { header: 'Buổi 126', key: 'buoi126' },
      { header: 'Buổi 127', key: 'buoi127' },
      { header: 'Buổi 128', key: 'buoi128' },
      { header: 'Buổi 129', key: 'buoi129' },
      { header: 'Buổi 130', key: 'buoi130' },
      { header: 'Buổi 131', key: 'buoi131' },
      { header: 'Buổi 132', key: 'buoi132' },
      { header: 'Buổi 133', key: 'buoi133' },
      { header: 'Buổi 134', key: 'buoi134' },
      { header: 'Buổi 135', key: 'buoi135' },
      { header: 'Buổi 136', key: 'buoi136' },
      { header: 'Buổi 137', key: 'buoi137' },
      { header: 'Buổi 138', key: 'buoi138' },
      { header: 'Buổi 139', key: 'buoi139' },
      { header: 'Buổi 140', key: 'buoi140' },
      { header: 'Buổi 141', key: 'buoi141' },
      { header: 'Buổi 142', key: 'buoi142' },
      { header: 'Buổi 143', key: 'buoi143' },
      { header: 'Buổi 144', key: 'buoi144' },
      { header: 'Buổi 145', key: 'buoi145' },
      { header: 'Buổi 146', key: 'buoi146' },
      { header: 'Buổi 147', key: 'buoi147' },
      { header: 'Buổi 148', key: 'buoi148' },
      { header: 'Buổi 149', key: 'buoi149' },
      { header: 'Buổi 150', key: 'buoi150' },
      { header: 'Buổi 151', key: 'buoi151' },
      { header: 'Buổi 152', key: 'buoi152' },
      { header: 'Buổi 153', key: 'buoi153' },
      { header: 'Buổi 154', key: 'buoi154' },
      { header: 'Buổi 155', key: 'buoi155' },
      { header: 'Buổi 156', key: 'buoi156' }
    ];

    worksheet.columns = classcolumns;
    worksheet2.columns = teachercolumns;
    worksheet3.columns = filterrows;
    
    classes.forEach((cls) => {
      worksheet3.addRow({
        name: cls.name
      })
    })
    classes.forEach((cls) => {
      worksheet.addRow({
        classID: cls.classID,
        name: cls.name,
        grade: cls.grade,
        place: cls.place,
        time1: cls.time1,
        time2: cls.time2,
        manualmathtea: cls.manualmathtea,
        manualengtea: cls.manualengtea,
        manuallittea: cls.manuallittea,
        manualscitea: cls.manualscitea,
        manualhistea: cls.manualhistea,
        automathtea: cls.automathtea,
        autoengtea: cls.autoengtea,
        autolittea: cls.autolittea,
        autoscitea: cls.autoscitea,
        autohistea: cls.autohistea,
        buoi1: cls.buoi1,
        buoi2: cls.buoi2,
        buoi3: cls.buoi3,
        buoi4: cls.buoi4,
        buoi5: cls.buoi5,
        buoi6: cls.buoi6,
        buoi7: cls.buoi7,
        buoi8: cls.buoi8,
        buoi9: cls.buoi9,
        buoi10: cls.buoi10,
        buoi11: cls.buoi11,
        buoi12: cls.buoi12,
        buoi13: cls.buoi13,
        buoi14: cls.buoi14,
        buoi15: cls.buoi15,
        buoi16: cls.buoi16,
        buoi17: cls.buoi17,
        buoi18: cls.buoi18,
        buoi19: cls.buoi19,
        buoi20: cls.buoi20,
        buoi21: cls.buoi21,
        buoi22: cls.buoi22,
        buoi23: cls.buoi23,
        buoi24: cls.buoi24,
        buoi25: cls.buoi25,
        buoi26: cls.buoi26,
        buoi27: cls.buoi27,
        buoi28: cls.buoi28,
        buoi29: cls.buoi29,
        buoi30: cls.buoi30,
        buoi31: cls.buoi31,
        buoi32: cls.buoi32,
        buoi33: cls.buoi33,
        buoi34: cls.buoi34,
        buoi35: cls.buoi35,
        buoi36: cls.buoi36,
        buoi37: cls.buoi37,
        buoi38: cls.buoi38,
        buoi39: cls.buoi39,
        buoi40: cls.buoi40,
        buoi41: cls.buoi41,
        buoi42: cls.buoi42,
        buoi43: cls.buoi43,
        buoi44: cls.buoi44,
        buoi45: cls.buoi45,
        buoi46: cls.buoi46,
        buoi47: cls.buoi47,
        buoi48: cls.buoi48,
        buoi49: cls.buoi49,
        buoi50: cls.buoi50,
        buoi51: cls.buoi51,
        buoi52: cls.buoi52,
        buoi53: cls.buoi53,
        buoi54: cls.buoi54,
        buoi55: cls.buoi55,
        buoi56: cls.buoi56,
        buoi57: cls.buoi57,
        buoi58: cls.buoi58,
        buoi59: cls.buoi59,
        buoi60: cls.buoi60,
        buoi61: cls.buoi61,
        buoi62: cls.buoi62,
        buoi63: cls.buoi63,
        buoi64: cls.buoi64,
        buoi65: cls.buoi65,
        buoi66: cls.buoi66,
        buoi67: cls.buoi67,
        buoi68: cls.buoi68,
        buoi69: cls.buoi69,
        buoi70: cls.buoi70,
        buoi71: cls.buoi71,
        buoi72: cls.buoi72,
        buoi73: cls.buoi73,
        buoi74: cls.buoi74,
        buoi75: cls.buoi75,
        buoi76: cls.buoi76,
        buoi77: cls.buoi77,
        buoi78: cls.buoi78,
        buoi79: cls.buoi79,
        buoi80: cls.buoi80,
        buoi81: cls.buoi81,
        buoi82: cls.buoi82,
        buoi83: cls.buoi83,
        buoi84: cls.buoi84,
        buoi85: cls.buoi85,
        buoi86: cls.buoi86,
        buoi87: cls.buoi87,
        buoi88: cls.buoi88,
        buoi89: cls.buoi89,
        buoi90: cls.buoi90,
        buoi91: cls.buoi91,
        buoi92: cls.buoi92,
        buoi93: cls.buoi93,
        buoi94: cls.buoi94,
        buoi95: cls.buoi95,
        buoi96: cls.buoi96,
        buoi97: cls.buoi97,
        buoi98: cls.buoi98,
        buoi99: cls.buoi99,
        buoi100: cls.buoi100,
        buoi101: cls.buoi101,
        buoi102: cls.buoi102,
        buoi103: cls.buoi103,
        buoi104: cls.buoi104,
        buoi105: cls.buoi105,
        buoi106: cls.buoi106,
        buoi107: cls.buoi107,
        buoi108: cls.buoi108,
        buoi109: cls.buoi109,
        buoi110: cls.buoi110,
        buoi111: cls.buoi111,
        buoi112: cls.buoi112,
        buoi113: cls.buoi113,
        buoi114: cls.buoi114,
        buoi115: cls.buoi115,
        buoi116: cls.buoi116,
        buoi117: cls.buoi117,
        buoi118: cls.buoi118,
        buoi119: cls.buoi119,
        buoi120: cls.buoi120,
        buoi121: cls.buoi121,
        buoi122: cls.buoi122,
        buoi123: cls.buoi123,
        buoi124: cls.buoi124,
        buoi125: cls.buoi125,
        buoi126: cls.buoi126,
        buoi127: cls.buoi127,
        buoi128: cls.buoi128,
        buoi129: cls.buoi129,
        buoi130: cls.buoi130,
        buoi131: cls.buoi131,
        buoi132: cls.buoi132,
        buoi133: cls.buoi133,
        buoi134: cls.buoi134,
        buoi135: cls.buoi135,
        buoi136: cls.buoi136,
        buoi137: cls.buoi137,
        buoi138: cls.buoi138,
        buoi139: cls.buoi139,
        buoi140: cls.buoi140,
        buoi141: cls.buoi141,
        buoi142: cls.buoi142,
        buoi143: cls.buoi143,
        buoi144: cls.buoi144,
        buoi145: cls.buoi145,
        buoi146: cls.buoi146,
        buoi147: cls.buoi147,
        buoi148: cls.buoi148,
        buoi149: cls.buoi149,
        buoi150: cls.buoi150,
        buoi151: cls.buoi151,
        buoi152: cls.buoi152,
        buoi153: cls.buoi153,
        buoi154: cls.buoi154,
        buoi155: cls.buoi155,
        buoi156: cls.buoi156
      });
    });
    teachers.forEach((tea) => {
      worksheet2.addRow({
        teacherID: tea.teacherID,
        name: tea.name,
        grade1: tea.grade1,
        grade2: tea.grade2,
        grade3: tea.grade3,
        grade4: tea.grade4,
        grade5: tea.grade5,
        grade6: tea.grade6,
        grade7: tea.grade7,
        grade8: tea.grade8,
        place1: tea.place1,
        place1: tea.place2,
        place1: tea.place3,
        place1: tea.place4,
        place1: tea.place5,
        place1: tea.place6,
        place1: tea.place7,
        place1: tea.place8,
        place1: tea.place9,
        place1: tea.place10,
        time1: tea.time1,
        time1: tea.time2,
        time1: tea.time3,
        time1: tea.time4,
        time1: tea.time5,
        time1: tea.time6,
        time1: tea.time7,
        time1: tea.time8,
        time1: tea.time9,
        time1: tea.time10,
        time1: tea.time11,
        time1: tea.time12,
        time1: tea.time13,
        buoi1: tea.buoi1,
        buoi2: tea.buoi2,
        buoi3: tea.buoi3,
        buoi4: tea.buoi4,
        buoi5: tea.buoi5,
        buoi6: tea.buoi6,
        buoi7: tea.buoi7,
        buoi8: tea.buoi8,
        buoi9: tea.buoi9,
        buoi10: tea.buoi10,
        buoi11: tea.buoi11,
        buoi12: tea.buoi12,
        buoi13: tea.buoi13,
        buoi14: tea.buoi14,
        buoi15: tea.buoi15,
        buoi16: tea.buoi16,
        buoi17: tea.buoi17,
        buoi18: tea.buoi18,
        buoi19: tea.buoi19,
        buoi20: tea.buoi20,
        buoi21: tea.buoi21,
        buoi22: tea.buoi22,
        buoi23: tea.buoi23,
        buoi24: tea.buoi24,
        buoi25: tea.buoi25,
        buoi26: tea.buoi26,
        buoi27: tea.buoi27,
        buoi28: tea.buoi28,
        buoi29: tea.buoi29,
        buoi30: tea.buoi30,
        buoi31: tea.buoi31,
        buoi32: tea.buoi32,
        buoi33: tea.buoi33,
        buoi34: tea.buoi34,
        buoi35: tea.buoi35,
        buoi36: tea.buoi36,
        buoi37: tea.buoi37,
        buoi38: tea.buoi38,
        buoi39: tea.buoi39,
        buoi40: tea.buoi40,
        buoi41: tea.buoi41,
        buoi42: tea.buoi42,
        buoi43: tea.buoi43,
        buoi44: tea.buoi44,
        buoi45: tea.buoi45,
        buoi46: tea.buoi46,
        buoi47: tea.buoi47,
        buoi48: tea.buoi48,
        buoi49: tea.buoi49,
        buoi50: tea.buoi50,
        buoi51: tea.buoi51,
        buoi52: tea.buoi52,
        buoi53: tea.buoi53,
        buoi54: tea.buoi54,
        buoi55: tea.buoi55,
        buoi56: tea.buoi56,
        buoi57: tea.buoi57,
        buoi58: tea.buoi58,
        buoi59: tea.buoi59,
        buoi60: tea.buoi60,
        buoi61: tea.buoi61,
        buoi62: tea.buoi62,
        buoi63: tea.buoi63,
        buoi64: tea.buoi64,
        buoi65: tea.buoi65,
        buoi66: tea.buoi66,
        buoi67: tea.buoi67,
        buoi68: tea.buoi68,
        buoi69: tea.buoi69,
        buoi70: tea.buoi70,
        buoi71: tea.buoi71,
        buoi72: tea.buoi72,
        buoi73: tea.buoi73,
        buoi74: tea.buoi74,
        buoi75: tea.buoi75,
        buoi76: tea.buoi76,
        buoi77: tea.buoi77,
        buoi78: tea.buoi78,
        buoi79: tea.buoi79,
        buoi80: tea.buoi80,
        buoi81: tea.buoi81,
        buoi82: tea.buoi82,
        buoi83: tea.buoi83,
        buoi84: tea.buoi84,
        buoi85: tea.buoi85,
        buoi86: tea.buoi86,
        buoi87: tea.buoi87,
        buoi88: tea.buoi88,
        buoi89: tea.buoi89,
        buoi90: tea.buoi90,
        buoi91: tea.buoi91,
        buoi92: tea.buoi92,
        buoi93: tea.buoi93,
        buoi94: tea.buoi94,
        buoi95: tea.buoi95,
        buoi96: tea.buoi96,
        buoi97: tea.buoi97,
        buoi98: tea.buoi98,
        buoi99: tea.buoi99,
        buoi100: tea.buoi100,
        buoi101: tea.buoi101,
        buoi102: tea.buoi102,
        buoi103: tea.buoi103,
        buoi104: tea.buoi104,
        buoi105: tea.buoi105,
        buoi106: tea.buoi106,
        buoi107: tea.buoi107,
        buoi108: tea.buoi108,
        buoi109: tea.buoi109,
        buoi110: tea.buoi110,
        buoi111: tea.buoi111,
        buoi112: tea.buoi112,
        buoi113: tea.buoi113,
        buoi114: tea.buoi114,
        buoi115: tea.buoi115,
        buoi116: tea.buoi116,
        buoi117: tea.buoi117,
        buoi118: tea.buoi118,
        buoi119: tea.buoi119,
        buoi120: tea.buoi120,
        buoi121: tea.buoi121,
        buoi122: tea.buoi122,
        buoi123: tea.buoi123,
        buoi124: tea.buoi124,
        buoi125: tea.buoi125,
        buoi126: tea.buoi126,
        buoi127: tea.buoi127,
        buoi128: tea.buoi128,
        buoi129: tea.buoi129,
        buoi130: tea.buoi130,
        buoi131: tea.buoi131,
        buoi132: tea.buoi132,
        buoi133: tea.buoi133,
        buoi134: tea.buoi134,
        buoi135: tea.buoi135,
        buoi136: tea.buoi136,
        buoi137: tea.buoi137,
        buoi138: tea.buoi138,
        buoi139: tea.buoi139,
        buoi140: tea.buoi140,
        buoi141: tea.buoi141,
        buoi142: tea.buoi142,
        buoi143: tea.buoi143,
        buoi144: tea.buoi144,
        buoi145: tea.buoi145,
        buoi146: tea.buoi146,
        buoi147: tea.buoi147,
        buoi148: tea.buoi148,
        buoi149: tea.buoi149,
        buoi150: tea.buoi150,
        buoi151: tea.buoi151,
        buoi152: tea.buoi152,
        buoi153: tea.buoi153,
        buoi154: tea.buoi154,
        buoi155: tea.buoi155,
        buoi156: tea.buoi156
      });
    });

    worksheet.getRow(1).font = { bold: true };
    worksheet.getRow(1).alignment = { vertical: 'middle', horizontal: 'center' };
    worksheet.mergeCells('E1:F1');

    worksheet2.getRow(1).font = { bold: true };
    worksheet2.getRow(1).alignment = { vertical: 'middle', horizontal: 'center' };
    worksheet2.mergeCells('D1:K1');
    worksheet2.mergeCells('L1:U1');

    let k=2;
    worksheet3.eachRow({ includeEmpty: false }, (row, rowNumber) => {
      if (rowNumber === 1) return; // Bỏ qua dòng header
      for(let i=1;i<157;i++){
        const vlookupResult = `IFERROR(VLOOKUP(VLOOKUP($A${k}, 'classdata-not-edit'!$B:$FP,${i+16},0),'teacherdata-not-edit'!$A:$B,2,0),"")`;
        row.getCell('buoi'+i).value = {
          formula: vlookupResult,
        };
      }
      k++;
    });
    const tranpose = `TRANSPOSE('Data-Filter-Ngang'!1:50)`
    const cellA1 = worksheet4.getCell('A1');
    cellA1.value = {
      formula: tranpose
    };
    const fileName = 'data.xlsx'; // Tên file Excel xuất ra
    res.setHeader(
      'Content-Type',
      'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'
    );
    res.setHeader('Content-Disposition', `attachment; filename="${fileName}"`);
    await workbook.xlsx.write(res);
    res.render('/index');
});

module.exports = router;
